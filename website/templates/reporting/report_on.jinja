{% extends "base.html" %}
{% block title %}{% endblock %}

{% block forestyle %}
<style>
        table, td, th {
                max-width: 960px;
                text-align:left;
                font-size: 14px;
                border-top: 1px solid #bdbdbd;
                border-right: 1px solid #bdbdbd;
        }
        .data_table {
                min-width: 320px;
        }
        td, th {
                padding: 4px;
                border: 1px solid #bdbdbd;
                border-top: 0 none;
                border-right: 0 none;
        }
        th {
                font-weight: normal;
        }
        td {
                text-align: right;
                color: #000;
                border-left: 2px solid #999;
        }
        .even {
                background-color: #ebf1fe;
        }
        .header_row_right {
                border-left: 2px solid #999;
                border-bottom: 2px solid #999;
                text-align: right;
                color: #333;
                font-weight: bold;
        }
        .header_row {
                border-bottom: 2px solid #999;
                color: #333;
                font-weight: bold;
        }
        hr {
                border: 0;
        height: 1px;
        background: #333;
        background-image: -webkit-linear-gradient(left, #ccc, #333, #ccc);
        background-image:    -moz-linear-gradient(left, #ccc, #333, #ccc);
        background-image:     -ms-linear-gradient(left, #ccc, #333, #ccc);
        background-image:      -o-linear-gradient(left, #ccc, #333, #ccc);
        }
        .legend-dot {
          border-radius: 50%;
          width: .8em;
          height: .8em;
          display: inline-block;
          margin: .1em .4em 0 .2em;
          background-color: transparent;
        }
        .report {
          max-width: 320px;
          margin-left: 25px;
          float: left;
        }
        .graph {
          width: 320px;
          height: 320px;
        }
</style>
{% endblock %}

{% block forejs %}
{% compress js %}
<script src="/media/js/raphael.js"></script>
<script src="/media/js/g.raphael.js"></script>
<script src="/media/js/g.pie.js"></script>
<script src="/media/js/g.bar.js"></script>
{% endcompress %}
{% endblock %}

{% block body %}
  <div class="contentOnlyPage">
    <h1>{{ report_name }} - Field Answer Reporting</h1>
    {% if question_instruction %}
      <hr/>
      <h2>Question's Instruction: {{ question_instruction }}</h2>
    {% endif %}
    <hr/>
    <h3>Current approved values
      {% if geo_filter %}
        {% if not filter_is_temporary %}
          filtered to the {{geo_filter.matches().count()}}
          jurisdictions in the area named
          &ldquo;<a href="{{url('geoarea-view', pk=geo_filter.pk)}}">{{ geo_filter.filter_name }}</a>&rdquo;
        {% else %}
          filtered to {{geo_filter_matches}} jurisdictions.
          <a href="{{url_params(url('geoarea-new-for-question',
                                    question_id=question_id),
                                **geo_filter_params)
                   }}">Edit current filter...</a>
        {% endif %}
      {% else %}
        . <a href="{{url('geoarea-new-for-question', question_id=question_id)}}">Filter this report...</a>
      {% endif %}
    </h3>
    {% for report in reports %}
      <div class="report" id="report{{report.idx}}">
        <div class="graph" id="graph{{report.idx}}"></div>
        <table class="data_table">
          <tr class="even">
            <th class="header_row">Value</th>
            <th class="header_row_right">Jurisdictions</th>
          </tr>
          {% for row in report.table %}
            <tr class="{{ loop.cycle('odd', 'even') }}">
              <th><span class="legend-dot"></span>{{ row['key'] }}</th>
              <td>{{ row['value'] }}</td>
            </tr>
          {% endfor %}
        </table>
      </div>
    {% endfor %}
  </div>
{% endblock %}

{% block endjs %}
  <script>
    var reports = {{reports_json|safe}};
  </script>
  <script src="/static/reporting/ui.js"></script>
{% endblock %}
